<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile | CICS AlertSOS</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>
<style>
  body, html {
    margin: 0;
    padding: 0;
    font-family: 'Inter', sans-serif;
    background-color: #f9fafb;
    transition: background 0.3s, color 0.3s;
  }

  main {
    min-height: 100vh;
    margin-left: 17rem;
    padding: 3rem 2rem;
    transition: all 0.3s ease-in-out;
  }
  @media (max-width: 1024px) { main { margin-left: 0; padding: 2rem 1rem; } }

  .card {
    border-radius: 1rem;
    padding: 2.5rem 2rem;
    box-shadow: 0 6px 18px rgba(0,0,0,0.07);
    background-color: #ffffff;
    max-width: 720px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .profile-pic {
    width: 140px;
    height: 140px;
    border-radius: 9999px;
    background-color: #d1d5db;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 2.5rem;
    color: white;
    overflow: hidden;
    border: 3px solid #f87171;
    transition: transform 0.2s;
  }
  .profile-pic:hover { transform: scale(1.05); }

  input:read-only { background-color: transparent; border: none; font-size: 1rem; }
  input, select, textarea, button {
    transition: all 0.3s;
    width: 100%;
    padding: 0.6rem 0.9rem;
    border-radius: 0.5rem;
    border: 1px solid #e5e7eb;
    font-size: 0.95rem;
  }
  input:focus, select:focus { outline: none; box-shadow: 0 0 0 2px rgba(248,113,113,0.3); border-color: #f87171; }

  .menu-btn { cursor: pointer; font-size: 1.8rem; color: #374151; }
  .menu-dropdown {
    display: none;
    position: absolute;
    right: 0;
    top: 2.5rem;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
    z-index: 10;
    box-shadow: 0 6px 15px rgba(0,0,0,0.12);
    min-width: 260px;
    padding: 1rem;
  }
  .menu-dropdown.active { display: block; }

  .menu-dropdown h2 { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; }
  button:hover { background-color: #ef4444; }

  label { font-weight: 500; margin-bottom: 0.25rem; display: block; }

  /* Dark / Red themes */
  body.theme-dark { background-color: #1f2937; color: #f9fafb; }
  body.theme-dark .card { background-color: #374151; }
  body.theme-dark input, body.theme-dark select, body.theme-dark textarea { background-color: #4b5563; color: #f9fafb; border-color: #6b7280; }
  body.theme-dark .bg-red-600 { background-color: #b91c1c; }

  body.theme-red { background-color: #fef2f2; color: #991b1b; }
  body.theme-red .card { background-color: #fee2e2; }
  body.theme-red input, body.theme-red select, body.theme-red textarea { background-color: #fef2e2; color: #991b1b; border-color: #fca5a5; }
  body.theme-red .bg-red-600 { background-color: #b91c1c; }

  /* Profile picture label */
  .profile-pic-label {
    position: absolute;
    bottom: 0;
    right: 0;
    background-color: #ef4444;
    color: white;
    padding: 0.6rem;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  .profile-pic-label:hover { background-color: #b91c1c; }
</style>
</head>
<body class="theme-light transition-colors">

<!-- Navbar & Sidebar -->
<custom-navbar class="relative z-50"></custom-navbar>
<custom-sidebar class="relative z-40"></custom-sidebar>

<main class="transition-all duration-300 pt-24"> <!-- pt-24 ensures card below navbar -->
  <div class="card relative">
    <!-- Header with Three Dots -->
    <div class="flex justify-between items-center relative">
      <h1 class="text-3xl font-bold text-gray-800">Profile Settings</h1>
      <span id="menuBtn" class="menu-btn">⋮</span>
      <div id="menuDropdown" class="menu-dropdown">
        <button id="editProfileBtn" class="w-full text-left py-2 px-2 hover:bg-gray-100 rounded">Edit Profile</button>
        <hr class="my-2 border-gray-300">
        <form id="dashboardSettingsForm" class="space-y-3">
          <h2>Dashboard Personalization</h2>
          <div>
            <label>Theme</label>
            <select id="themeSelect" class="w-full border border-gray-300 rounded-md px-3 py-2">
              <option value="light">Light</option>
              <option value="dark">Dark</option>
              <option value="red">Red Accent</option>
            </select>
          </div>
          <div>
            <label>Sidebar Layout</label>
            <select id="sidebarLayout" class="w-full border border-gray-300 rounded-md px-3 py-2">
              <option value="expanded">Expanded</option>
              <option value="compact">Compact</option>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <input type="checkbox" id="notificationsToggle" class="h-5 w-5 accent-red-600">
            <label for="notificationsToggle" class="text-sm font-medium">Enable notifications</label>
          </div>
          <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition w-full">Save</button>
        </form>
      </div>
    </div>

    <!-- Profile Picture -->
    <div class="flex flex-col items-center relative mt-6">
      <div id="profilePicPreview" class="profile-pic">JD</div>
      <label for="profilePicInput" class="profile-pic-label">
        <i data-feather="camera"></i>
      </label>
      <input type="file" id="profilePicInput" accept="image/*" class="hidden">
      <p class="text-sm text-gray-500 text-center mt-2">Tap the camera icon to change your profile picture</p>
    </div>

    <!-- Profile Info -->
    <form id="profileForm" class="space-y-4 mt-6">
      <div>
        <label>Full Name</label>
        <input type="text" value="John Doe" placeholder="Johnathan Alexander Doe the Third" readonly>
      </div>
      <div>
        <label>Email</label>
        <input type="email" value="john.doe@cics.edu" placeholder="johnathan.alexander.doe@example.cics.edu" readonly>
      </div>
      <div>
        <label>Phone Number</label>
        <input type="tel" value="+1 234 567 8901" placeholder="+63 912 345 6789" readonly>
      </div>
      <div>
        <label>Address</label>
        <input type="text" value="123 University Ave, Campus City" placeholder="123 University Avenue, CICS Campus" readonly>
      </div>
      <button type="submit" id="saveProfileBtn" class="hidden mt-3 bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 w-full sm:w-auto transition">Save Changes</button>
    </form>
  </div>
</main>

<script src="components/navbar.js"></script>
<script src="components/sidebar.js"></script>
<script>
feather.replace();

// Three dots menu toggle
const menuBtn = document.getElementById('menuBtn');
const menuDropdown = document.getElementById('menuDropdown');
menuBtn.addEventListener('click', () => menuDropdown.classList.toggle('active'));

// Edit Profile toggle
const editProfileBtn = document.getElementById('editProfileBtn');
const profileForm = document.getElementById('profileForm');
const saveBtn = document.getElementById('saveProfileBtn');
editProfileBtn.addEventListener('click', () => {
  profileForm.querySelectorAll('input').forEach(input => input.readOnly = false);
  saveBtn.classList.remove('hidden');
  menuDropdown.classList.remove('active');
});

// Profile picture preview
const profilePicInput = document.getElementById('profilePicInput');
const profilePicPreview = document.getElementById('profilePicPreview');
profilePicInput.addEventListener('change', function() {
  const file = this.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = e => {
      profilePicPreview.innerHTML = '';
      const img = document.createElement('img');
      img.src = e.target.result;
      img.className = 'w-full h-full object-cover rounded-full';
      profilePicPreview.appendChild(img);
    };
    reader.readAsDataURL(file);
  }
});

// Profile form submit
profileForm.addEventListener('submit', e => {
  e.preventDefault();
  profileForm.querySelectorAll('input').forEach(input => input.readOnly = true);
  saveBtn.classList.add('hidden');
  alert('✅ Profile updated successfully!');
});

// Dashboard personalization
const dashboardForm = document.getElementById('dashboardSettingsForm');
dashboardForm.addEventListener('submit', e => {
  e.preventDefault();
  const theme = document.getElementById('themeSelect').value;
  const sidebar = document.getElementById('sidebarLayout').value;
  const notifications = document.getElementById('notificationsToggle').checked;

  document.body.classList.remove('theme-light','theme-dark','theme-red');
  document.body.classList.add('theme-'+theme);
  document.querySelector('custom-sidebar').style.width = sidebar === 'compact' ? '5rem' : '17rem';

  alert(`✅ Dashboard personalization applied! Notifications ${notifications ? 'enabled' : 'disabled'}`);
});
</script>
</body>
</html>
